{"title":"GitHub - profectus-engine/Profectus: A game engine that grows with you","kind":"edit","description":"<p>diff --git a/src/components/Layer.vue b/src/components/Layer.vue<br>\nindex 6938361…692ccac 100644<br>\n— a/src/components/Layer.vue<br>\n+++ b/src/components/Layer.vue<br>\n@@ -25,22 +25,23 @@</p>\n <script setup lang=\"ts\">\n import projInfo from \"data/projInfo.json\";\n-import { Layer, type FeatureNode } from \"game/layers\";\n+import { type FeatureNode } from \"game/layers\";\n import player from \"game/player\";\n-import { render } from \"util/vue\";\n-import { computed, onErrorCaptured, ref, unref } from \"vue\";\n+import { MaybeGetter } from \"util/computed\";\n+import { render, Renderable } from \"util/vue\";\n+import { computed, MaybeRef, onErrorCaptured, Ref, ref, unref } from \"vue\";\n import Context from \"./Context.vue\";\n import ErrorVue from \"./Error.vue\";\n \n const props = defineProps<{\n-    display: Layer[\"display\"];\n-    minimizedDisplay: Layer[\"minimizedDisplay\"];\n-    minimized: Layer[\"minimized\"];\n-    name: Layer[\"name\"];\n-    color: Layer[\"color\"];\n-    minimizable: Layer[\"minimizable\"];\n-    nodes: Layer[\"nodes\"];\n-    forceHideGoBack: Layer[\"forceHideGoBack\"];\n+    display: MaybeGetter<Renderable>;\n+    minimizedDisplay?: MaybeGetter<Renderable>;\n+    minimized: Ref<boolean>;\n+    name?: MaybeRef<string>;\n+    color?: MaybeRef<string>;\n+    minimizable?: MaybeRef<boolean>;\n+    nodes: Ref<Record<string, FeatureNode | undefined>>;\n+    forceHideGoBack?: MaybeRef<boolean>;\n     index: number;\n }>();\n \ndiff --git a/src/components/Nav.vue b/src/components/Nav.vue\nindex 2ad4fac..e013825 100644\n--- a/src/components/Nav.vue\n+++ b/src/components/Nav.vue\n@@ -88,7 +88,7 @@\n             </ul>\n         </div>\n     </div>\n-    <Info ref=\"info\" :changelog=\"changelog\" />\n+    <Info ref=\"info\" @open-changelog=\"changelog?.open()\" />\n     <SavesManager ref=\"savesManager\" />\n     <Options ref=\"options\" />\n     <Changelog ref=\"changelog\" />\n@@ -97,22 +97,19 @@\n <script setup lang=\"ts\">\n import Changelog from \"data/Changelog.vue\";\n import projInfo from \"data/projInfo.json\";\n-import Tooltip from \"wrappers/tooltips/Tooltip.vue\";\n import settings from \"game/settings\";\n import { Direction } from \"util/common\";\n import { galaxy, syncedSaves } from \"util/galaxy\";\n-import type { ComponentPublicInstance } from \"vue\";\n import { computed, ref } from \"vue\";\n+import Tooltip from \"wrappers/tooltips/Tooltip.vue\";\n import Info from \"./modals/Info.vue\";\n import Options from \"./modals/Options.vue\";\n import SavesManager from \"./modals/SavesManager.vue\";\n \n-const info = ref<ComponentPublicInstance<typeof Info> | null>(null);\n-const savesManager = ref<ComponentPublicInstance<typeof SavesManager> | null>(null);\n-const options = ref<ComponentPublicInstance<typeof Options> | null>(null);\n-// For some reason Info won't accept the changelog unless I do this:\n-// eslint-disable-next-line @typescript-eslint/no-explicit-any\n-const changelog = ref<ComponentPublicInstance<any> | null>(null);\n+const info = ref<typeof Info | null>(null);\n+const savesManager = ref<typeof SavesManager | null>(null);\n+const options = ref<typeof Options | null>(null);\n+const changelog = ref<typeof Changelog | null>(null);\n \n const { useHeader, banner, title, discordName, discordLink, versionNumber } = projInfo;\n \ndiff --git a/src/components/modals/Info.vue b/src/components/modals/Info.vue\nindex 6370482..e92b5e8 100644\n--- a/src/components/modals/Info.vue\n+++ b/src/components/modals/Info.vue\n@@ -18,7 +18,7 @@\n                     Made in Profectus, by thepaperpilot with inspiration from Acameada and Jacorb\n                 </div>\n                 <br />\n-                <div class=\"link\" @click=\"openChangelog\">Changelog</div>\n+                <div class=\"link\" @click=\"emits('openChangelog')\">Changelog</div>\n                 <br />\n                 <div>\n                     <a\n@@ -60,7 +60,6 @@\n </template>\n \n <script setup lang=\"tsx\">\n-import type Changelog from \"data/Changelog.vue\";\n import projInfo from \"data/projInfo.json\";\n import player from \"game/player\";\n import { infoComponents } from \"game/settings\";\n@@ -71,7 +70,9 @@ import Modal from \"./Modal.vue\";\n \n const { title, logo, author, discordName, discordLink, versionNumber, versionTitle } = projInfo;\n \n-const props = defineProps<{ changelog: typeof Changelog | null }>();\n+const emits = defineEmits<{\n+    (e: \"openChangelog\"): void;\n+}>();\n \n const isOpen = ref(false);\n \n@@ -84,10 +85,6 @@ defineExpose({\n         isOpen.value = true;\n     }\n });\n-\n-function openChangelog() {\n-    props.changelog?.open();\n-}\n </script>\n <style scoped>\ndiff --git a/src/components/modals/Modal.vue b/src/components/modals/Modal.vue\nindex 944af7b..0394b41 100644\n--- a/src/components/modals/Modal.vue\n+++ b/src/components/modals/Modal.vue\n@@ -15,14 +15,26 @@\n                 <div class=\"modal-wrapper\">\n                     <div class=\"modal-container\" :width=\"width\">\n                         <div class=\"modal-header\">\n-                            <slot name=\"header\" :shown=\"isOpen\"> default header </slot>\n+                            <!--\n+                                @slot Modal Header\n+                                  @binding {boolean} shown Whether the modal is currently open or animating\n+                              -->\n+                            <slot name=\"header\" :shown=\"isOpen\" />\n                         </div>\n                         <div class=\"modal-body\">\n                             <Context ref=\"contextRef\">\n-                                <slot name=\"body\" :shown=\"isOpen\"> default body </slot>\n+                                <!--\n+                                    @slot Modal Body\n+                                      @binding {boolean} shown Whether the modal is currently open or animating\n+                                  -->\n+                                <slot name=\"body\" :shown=\"isOpen\" />\n                             </Context>\n                         </div>\n                         <div class=\"modal-footer\">\n+                            <!--\n+                                @slot Modal Footer\n+                                  @binding {boolean} shown Whether the modal is currently open or animating\n+                              -->\n                             <slot name=\"footer\" :shown=\"isOpen\">\n                                 <div class=\"modal-default-footer\">\n                                     <div class=\"modal-default-flex-grow\"></div>\ndiff --git a/src/components/modals/Save.vue b/src/components/modals/Save.vue\nindex 47e07df..02c3fcc 100644\n--- a/src/components/modals/Save.vue\n+++ b/src/components/modals/Save.vue\n@@ -75,15 +75,15 @@\n </template>\n \n <script setup lang=\"ts\">\n-import Tooltip from \"wrappers/tooltips/Tooltip.vue\";\n import player from \"game/player\";\n import { Direction } from \"util/common\";\n import { galaxy, syncedSaves } from \"util/galaxy\";\n+import { LoadablePlayerData } from \"util/save\";\n import { computed, ref, watch } from \"vue\";\n+import Tooltip from \"wrappers/tooltips/Tooltip.vue\";\n import DangerButton from \"../fields/DangerButton.vue\";\n import FeedbackButton from \"../fields/FeedbackButton.vue\";\n import Text from \"../fields/Text.vue\";\n-import type { LoadablePlayerData } from \"./SavesManager.vue\";\n \n const props = defineProps<{\n     save: LoadablePlayerData;\ndiff --git a/src/components/modals/SavesManager.vue b/src/components/modals/SavesManager.vue\nindex 2097ae9..b482225 100644\n--- a/src/components/modals/SavesManager.vue\n+++ b/src/components/modals/SavesManager.vue\n@@ -72,6 +72,7 @@ import {\n     decodeSave,\n     getCachedSave,\n     getUniqueID,\n+    LoadablePlayerData,\n     loadSave,\n     newSave,\n     save\n@@ -84,8 +85,6 @@ import Text from \"../fields/Text.vue\";\n import Modal from \"./Modal.vue\";\n import Save from \"./Save.vue\";\n \n-export type LoadablePlayerData = Omit<Partial<Player>, \"id\"> & { id: string; error?: unknown };\n-\n const isOpen = ref(false);\n const modal = ref<ComponentPublicInstance<typeof Modal> | null>(null);\n \ndiff --git a/src/features/VueFeature.vue b/src/features/VueFeature.vue\nindex ad787ad..adedca2 100644\n--- a/src/features/VueFeature.vue\n+++ b/src/features/VueFeature.vue\n@@ -19,13 +19,13 @@ import Node from \"components/Node.vue\";\n import type { Visibility } from \"features/feature\";\n import { isHidden, isVisible } from \"features/feature\";\n import { MaybeGetter } from \"util/computed\";\n-import { render, Renderable } from \"util/vue\";\n+import { render, Renderable, Wrapper } from \"util/vue\";\n import { MaybeRef, unref, type CSSProperties } from \"vue\";\n \n const props = withDefaults(defineProps<{\n     id: string;\n     components: MaybeGetter<Renderable>[];\n-    wrappers: ((el: () => Renderable) => Renderable)[];\n+    wrappers: Wrapper[];\n     visibility?: MaybeRef<Visibility | boolean>;\n     style?: MaybeRef<CSSProperties>;\n     classes?: MaybeRef<Record<string, boolean>>;\ndiff --git a/src/features/achievements/Achievement.vue b/src/features/achievements/Achievement.vue\nindex 3cced62..454fa3d 100644\n--- a/src/features/achievements/Achievement.vue\n+++ b/src/features/achievements/Achievement.vue\n@@ -16,16 +16,17 @@\n \n <script setup lang=\"tsx\">\n import \"components/common/features.css\";\n-import { render } from \"util/vue\";\n-import { Component, unref } from \"vue\";\n-import { Achievement } from \"./achievement\";\n+import { Requirements } from \"game/requirements\";\n+import { MaybeGetter } from \"util/computed\";\n+import { render, Renderable } from \"util/vue\";\n+import { Component, MaybeRef, Ref, unref } from \"vue\";\n \n const props = defineProps<{\n-    display: Achievement[\"display\"];\n-    earned: Achievement[\"earned\"];\n-    requirements: Achievement[\"requirements\"];\n-    image: Achievement[\"image\"];\n-    small: Achievement[\"small\"];\n+    display?: MaybeGetter<Renderable>;\n+    earned: Ref<boolean>;\n+    requirements?: Requirements;\n+    image?: MaybeRef<string>;\n+    small?: MaybeRef<boolean>;\n }>();\n \n const Component = () => props.display == null ? <></> : render(props.display);\ndiff --git a/src/features/bars/Bar.vue b/src/features/bars/Bar.vue\nindex a84cda9..047500e 100644\n--- a/src/features/bars/Bar.vue\n+++ b/src/features/bars/Bar.vue\n@@ -31,23 +31,23 @@\n </template>\n \n <script setup lang=\"ts\">\n-import Decimal from \"util/bignum\";\n+import Decimal, { DecimalSource } from \"util/bignum\";\n import { Direction } from \"util/common\";\n-import { render } from \"util/vue\";\n-import type { CSSProperties } from \"vue\";\n+import { MaybeGetter } from \"util/computed\";\n+import { render, Renderable } from \"util/vue\";\n+import type { CSSProperties, MaybeRef } from \"vue\";\n import { computed, unref } from \"vue\";\n-import { Bar } from \"./bar\";\n \n const props = defineProps<{\n-    width: Bar[\"width\"];\n-    height: Bar[\"height\"];\n-    direction: Bar[\"direction\"];\n-    borderStyle: Bar[\"borderStyle\"];\n-    baseStyle: Bar[\"baseStyle\"];\n-    textStyle: Bar[\"textStyle\"];\n-    fillStyle: Bar[\"fillStyle\"];\n-    progress: Bar[\"progress\"];\n-    display: Bar[\"display\"];\n+    width: MaybeRef<number>;\n+    height: MaybeRef<number>;\n+    direction: MaybeRef<Direction>;\n+    borderStyle?: MaybeRef<CSSProperties>;\n+    baseStyle?: MaybeRef<CSSProperties>;\n+    textStyle?: MaybeRef<CSSProperties>;\n+    fillStyle?: MaybeRef<CSSProperties>;\n+    progress: MaybeRef<DecimalSource>;\n+    display?: MaybeGetter<Renderable>;\n }>();\n \n const normalizedProgress = computed(() => {\ndiff --git a/src/features/challenges/Challenge.vue b/src/features/challenges/Challenge.vue\nindex 915bd1e..1963d59 100644\n--- a/src/features/challenges/Challenge.vue\n+++ b/src/features/challenges/Challenge.vue\n@@ -10,7 +10,7 @@\n     >\n         <button\n             class=\"toggleChallenge\"\n-            @click=\"toggle\"\n+            @click=\"emits('toggle')\"\n             :disabled=\"!unref(canStart) || unref(maxed)\"\n         >\n             {{ buttonText }}\n@@ -22,20 +22,25 @@\n <script setup lang=\"tsx\">\n import \"components/common/features.css\";\n import { getHighNotifyStyle, getNotifyStyle } from \"game/notifications\";\n-import { render } from \"util/vue\";\n-import type { Component } from \"vue\";\n+import { Requirements } from \"game/requirements\";\n+import { DecimalSource } from \"util/bignum\";\n+import { MaybeGetter } from \"util/computed\";\n+import { render, Renderable } from \"util/vue\";\n+import type { Component, MaybeRef, Ref } from \"vue\";\n import { computed, unref } from \"vue\";\n-import { Challenge } from \"./challenge\";\n \n const props = defineProps<{\n-    active: Challenge[\"active\"];\n-    maxed: Challenge[\"maxed\"];\n-    canComplete: Challenge[\"canComplete\"];\n-    display: Challenge[\"display\"];\n-    requirements: Challenge[\"requirements\"];\n-    completed: Challenge[\"completed\"];\n-    canStart: Challenge[\"canStart\"];\n-    toggle: Challenge[\"toggle\"];\n+    active: Ref<boolean>;\n+    maxed: Ref<boolean>;\n+    canComplete: Ref<DecimalSource>;\n+    display?: MaybeGetter<Renderable>;\n+    requirements: Requirements;\n+    completed: Ref<boolean>;\n+    canStart?: MaybeRef<boolean>;\n+}>();\n+\n+const emits = defineEmits<{\n+    (e: \"toggle\"): void;\n }>();\n \n const buttonText = computed(() => {\ndiff --git a/src/features/challenges/challenge.tsx b/src/features/challenges/challenge.tsx\nindex 213ff6d..0fe3cee 100644\n--- a/src/features/challenges/challenge.tsx\n+++ b/src/features/challenges/challenge.tsx\n@@ -129,7 +129,7 @@ export function createChallenge<T extends ChallengeOptions>(optionsFunc: () => T\n                 requirements={challenge.requirements}\n                 completed={challenge.completed}\n                 canStart={challenge.canStart}\n-                toggle={challenge.toggle}\n+                onToggle={challenge.toggle}\n             />\n         ));\n \ndiff --git a/src/features/clickables/Clickable.vue b/src/features/clickables/Clickable.vue\nindex 5a52dc3..c3294d7 100644\n--- a/src/features/clickables/Clickable.vue\n+++ b/src/features/clickables/Clickable.vue\n@@ -1,6 +1,6 @@\n <template>\n     <button\n-        @click=\"onClick\"\n+        @click=\"e => emits('click', e)\"\n         @mousedown=\"start\"\n         @mouseleave=\"stop\"\n         @mouseup=\"stop\"\n@@ -20,24 +20,28 @@\n \n <script setup lang=\"tsx\">\n import \"components/common/features.css\";\n-import type { Clickable } from \"features/clickables/clickable\";\n+import { MaybeGetter } from \"util/computed\";\n import {\n     render,\n+    Renderable,\n     setupHoldToClick\n } from \"util/vue\";\n-import type { Component } from \"vue\";\n-import { toRef, unref } from \"vue\";\n+import type { Component, MaybeRef } from \"vue\";\n+import { unref } from \"vue\";\n \n const props = defineProps<{\n-    canClick: Clickable[\"canClick\"];\n-    onClick: Clickable[\"onClick\"];\n-    onHold?: Clickable[\"onHold\"];\n-    display: Clickable[\"display\"];\n+    canClick: MaybeRef<boolean>;\n+    display?: MaybeGetter<Renderable>;\n+}>();\n+\n+const emits = defineEmits<{\n+    (e: \"click\", event?: MouseEvent | TouchEvent): void;\n+    (e: \"hold\"): void;\n }>();\n \n const Component = () => props.display == null ? <></> : render(props.display);\n \n-const { start, stop } = setupHoldToClick(toRef(props, \"onClick\"), toRef(props, \"onHold\"));\n+const { start, stop } = setupHoldToClick(() => emits(\"hold\"));\n </script>\n <style scoped>\ndiff --git a/src/features/clickables/action.tsx b/src/features/clickables/action.tsx\nindex c05b91d..df3ed18 100644\n--- a/src/features/clickables/action.tsx\n+++ b/src/features/clickables/action.tsx\n@@ -2,8 +2,8 @@ import ClickableVue from \"features/clickables/Clickable.vue\";\n import { findFeatures } from \"features/feature\";\n import { globalBus } from \"game/events\";\n import { persistent } from \"game/persistence\";\n-import Decimal, { DecimalSource } from \"lib/break_eternity\";\n import { Unsubscribe } from \"nanoevents\";\n+import Decimal, { DecimalSource } from \"util/bignum\";\n import { Direction } from \"util/common\";\n import { MaybeGetter, processGetter } from \"util/computed\";\n import { createLazyProxy } from \"util/proxies\";\n@@ -125,6 +125,7 @@ export function createAction<T extends ActionOptions>(optionsFunc?: () => T) {\n                     <ClickableVue\n                         canClick={action.canClick}\n                         onClick={action.onClick}\n+                        onHold={action.onClick}\n                         display={action.display}\n                     />\n                 )\ndiff --git a/src/features/clickables/clickable.tsx b/src/features/clickables/clickable.tsx\nindex 1268f46..859099f 100644\n--- a/src/features/clickables/clickable.tsx\n+++ b/src/features/clickables/clickable.tsx\n@@ -87,6 +87,7 @@ export function createClickable<T extends ClickableOptions>(optionsFunc?: () =>\n                 <Clickable\n                     canClick={clickable.canClick}\n                     onClick={clickable.onClick}\n+                    onHold={clickable.onClick}\n                     display={clickable.display}\n                 />\n             )),\n@@ -95,7 +96,7 @@ export function createClickable<T extends ClickableOptions>(optionsFunc?: () =>\n             onClick:\n                 onClick == null\n                     ? undefined\n-                    : function (e) {\n+                    : function (e?: MouseEvent | TouchEvent) {\n                           if (unref(clickable.canClick) !== false) {\n                               onClick.call(clickable, e);\n                           }\ndiff --git a/src/features/clickables/repeatable.tsx b/src/features/clickables/repeatable.tsx\nindex 4f36c5f..9c78cff 100644\n--- a/src/features/clickables/repeatable.tsx\n+++ b/src/features/clickables/repeatable.tsx\n@@ -98,6 +98,7 @@ export function createRepeatable<T extends RepeatableOptions>(optionsFunc: () =>\n             <Clickable\n                 canClick={repeatable.canClick}\n                 onClick={repeatable.onClick}\n+                onHold={repeatable.onClick}\n                 display={repeatable.display}\n             />\n         ));\ndiff --git a/src/features/feature.ts b/src/features/feature.ts\nindex e669f0d..5523c28 100644\n--- a/src/features/feature.ts\n+++ b/src/features/feature.ts\n@@ -23,16 +23,35 @@ export enum Visibility {\n     None\n }\n \n+/**\n+ * Utility function for determining if a visibility value is anything but Visibility.None.\n+ Booleans are allowed and false will be considered to be Visibility.None.\n+ * @param visibility The ref to either a visibility value or boolean\n+ * @returns True if the visibility is either true, Visibility.Visible, or Visibility.Hidden\n+ */\n export function isVisible(visibility: MaybeRef<Visibility | boolean>) {\n     const currVisibility = unref(visibility);\n     return currVisibility !== Visibility.None && currVisibility !== false;\n }\n \n+/**\n+ * Utility function for determining if a visibility value is Visibility.Hidden.\n+ Booleans are allowed but will never be considered to be Visible.Hidden.\n+ * @param visibility The ref to either a visibility value or boolean\n+ * @returns True if the visibility is Visibility.Hidden\n+ */\n export function isHidden(visibility: MaybeRef<Visibility | boolean>) {\n     const currVisibility = unref(visibility);\n     return currVisibility === Visibility.Hidden;\n }\n \n+/**\n+ * Utility function for narrowing something that may or may not be a specified type of feature.\n+ * Works off the principle that all features have a unique symbol to identify themselves with.\n+ * @param object The object to determine whether or not is of the specified type\n+ * @param type The symbol to look for in the object's \"type\" property\n+ * @returns Whether or not the object is the specified type\n+ */\n export function isType<T extends symbol>(object: unknown, type: T): object is { type: T } {\n     return object != null && typeof object === \"object\" && \"type\" in object && object.type === type;\n }\n@@ -64,6 +83,12 @@ export function findFeatures(obj: object, ...types: symbol[]): unknown[] {\n     return objects;\n }\n \n+/**\n+ * Utility function for taking a list of features and filtering them out, but keeping a reference to the first filtered out feature. Used for having a collapsible of the filtered out content, with the first filtered out item remaining outside the collapsible for easy reference.\n+ * @param features The list of features to search through\n+ * @param filter The filter to use to determine features that shouldn't be collapsible\n+ * @returns An object containing a ref to the first filtered _out_ feature, a render function for the collapsed content, and a ref for whether or not there is any collapsed content to show\n+ */\n export function getFirstFeature<T extends VueFeature>(\n     features: T[],\n     filter: (feature: T) => boolean\ndiff --git a/src/features/infoboxes/Infobox.vue b/src/features/infoboxes/Infobox.vue\nindex 39f875c..429aa4e 100644\n--- a/src/features/infoboxes/Infobox.vue\n+++ b/src/features/infoboxes/Infobox.vue\n@@ -26,17 +26,17 @@\n import CollapseTransition from \"@ivanv/vue-collapse-transition/src/CollapseTransition.vue\";\n import themes from \"data/themes\";\n import settings from \"game/settings\";\n-import { render } from \"util/vue\";\n-import { computed, unref } from \"vue\";\n-import { Infobox } from \"./infobox\";\n+import { MaybeGetter } from \"util/computed\";\n+import { render, Renderable } from \"util/vue\";\n+import { computed, CSSProperties, MaybeRef, Ref, unref } from \"vue\";\n \n const props = defineProps<{\n-    color: Infobox[\"color\"];\n-    titleStyle: Infobox[\"titleStyle\"];\n-    bodyStyle: Infobox[\"bodyStyle\"];\n-    collapsed: Infobox[\"collapsed\"];\n-    display: Infobox[\"display\"];\n-    title: Infobox[\"title\"];\n+    color?: MaybeRef<string>;\n+    titleStyle?: MaybeRef<CSSProperties>;\n+    bodyStyle?: MaybeRef<CSSProperties>;\n+    collapsed: Ref<boolean>;\n+    display: MaybeGetter<Renderable>;\n+    title: MaybeGetter<Renderable>;\n }>();\n \n const Title = () => render(props.title);\ndiff --git a/src/features/links/Links.vue b/src/features/links/Links.vue\nindex c33b8d7..934a41c 100644\n--- a/src/features/links/Links.vue\n+++ b/src/features/links/Links.vue\n@@ -15,11 +15,11 @@\n <script setup lang=\"ts\">\n import type { FeatureNode } from \"game/layers\";\n import { BoundsInjectionKey, NodesInjectionKey } from \"game/layers\";\n-import { computed, inject, onMounted, ref, shallowRef, unref, watch } from \"vue\";\n+import { computed, inject, MaybeRef, onMounted, ref, shallowRef, unref, watch } from \"vue\";\n import LinkVue from \"./Link.vue\";\n-import { Links } from \"./links\";\n+import { Link } from \"./links\";\n \n-const props = defineProps<{ links: Links[\"links\"] }>();\n+const props = defineProps<{ links: MaybeRef<Link[]> }>();\n \n function updateBounds() {\n     boundingRect.value = resizeListener.value?.getBoundingClientRect();\ndiff --git a/src/features/particles/Particles.vue b/src/features/particles/Particles.vue\nindex 2ec2f0b..2dd5db3 100644\n--- a/src/features/particles/Particles.vue\n+++ b/src/features/particles/Particles.vue\n@@ -9,13 +9,12 @@\n import { Application } from \"@pixi/app\";\n import { globalBus } from \"game/events\";\n import \"lib/pixi\";\n-import { nextTick, onBeforeUnmount, onMounted, shallowRef, unref } from \"vue\";\n-import type { Particles } from \"./particles\";\n+import { nextTick, onBeforeUnmount, onMounted, shallowRef } from \"vue\";\n \n-const props = defineProps<{\n-    onContainerResized: Particles[\"onContainerResized\"];\n-    onHotReload: Particles[\"onHotReload\"];\n-    onInit: (app: Application) => void;\n+const emits = defineEmits<{\n+    (e: \"containerResized\", boundingRect: DOMRect): void;\n+    (e: \"hotReload\"): void;\n+    (e: \"init\", app: Application): void;\n }>();\n \n const app = shallowRef<null | Application>(null);\n@@ -32,12 +31,10 @@ onMounted(() => {\n             backgroundAlpha: 0\n         });\n         resizeListener.value?.appendChild(app.value.view);\n-        props.onInit(app.value);\n+        emits(\"init\", app.value);\n     }\n     updateBounds();\n-    if (props.onHotReload) {\n-        nextTick(props.onHotReload);\n-    }\n+    nextTick(() => emits(\"hotReload\"));\n });\n onBeforeUnmount(() => {\n     app.value?.destroy();\n@@ -50,7 +47,7 @@ function updateBounds() {\n         isDirty = false;\n         nextTick(() => {\n             if (resizeListener.value != null) {\n-                props.onContainerResized?.(resizeListener.value.getBoundingClientRect());\n+                emits(\"containerResized\", resizeListener.value.getBoundingClientRect());\n             }\n             isDirty = true;\n         });\ndiff --git a/src/features/reset.ts b/src/features/reset.ts\nindex c9c7f06..32efac6 100644\n--- a/src/features/reset.ts\n+++ b/src/features/reset.ts\n@@ -18,7 +18,7 @@ import { isRef, MaybeRef, MaybeRefOrGetter, unref } from \"vue\";\n export const ResetType = Symbol(\"Reset\");\n \n /**\n- * An object that configures a {@link Clickable}.\n+ * An object that configures a {@link features/clickables/clickable.Clickable}.\n  */\n export interface ResetOptions {\n     /** List of things to reset. Can include objects which will be recursed over for persistent values. */\ndiff --git a/src/features/resources/MainDisplay.vue b/src/features/resources/MainDisplay.vue\nindex 3dab4d6..7592208 100644\n--- a/src/features/resources/MainDisplay.vue\n+++ b/src/features/resources/MainDisplay.vue\n@@ -21,13 +21,13 @@ import ResourceVue from \"features/resources/Resource.vue\";\n import Decimal from \"util/bignum\";\n import { MaybeGetter } from \"util/computed\";\n import { Renderable } from \"util/vue\";\n-import { computed, ref, StyleValue, toValue } from \"vue\";\n+import { computed, CSSProperties, ref, toValue } from \"vue\";\n \n const props = defineProps<{\n     resource: Resource;\n     color?: string;\n     classes?: Record<string, boolean>;\n-    style?: StyleValue;\n+    style?: CSSProperties;\n     effectDisplay?: MaybeGetter<Renderable>;\n }>();\n \ndiff --git a/src/features/tabs/TabButton.vue b/src/features/tabs/TabButton.vue\nindex 05f5a7f..cc513e2 100644\n--- a/src/features/tabs/TabButton.vue\n+++ b/src/features/tabs/TabButton.vue\n@@ -5,16 +5,16 @@\n </template>\n \n <script setup lang=\"ts\">\n-import { getNotifyStyle } from \"game/notifications\";\n-import { render } from \"util/vue\";\n-import { computed, unref } from \"vue\";\n-import { TabButton } from \"./tabFamily\";\n import themes from \"data/themes\";\n+import { getNotifyStyle } from \"game/notifications\";\n import settings from \"game/settings\";\n+import { MaybeGetter } from \"util/computed\";\n+import { render, Renderable } from \"util/vue\";\n+import { computed, MaybeRef, unref } from \"vue\";\n \n const props = defineProps<{\n-    display: TabButton[\"display\"];\n-    glowColor: TabButton[\"glowColor\"];\n+    display: MaybeGetter<Renderable>;\n+    glowColor?: MaybeRef<string>;\n     active?: boolean;\n }>();\n \ndiff --git a/src/features/tabs/TabFamily.vue b/src/features/tabs/TabFamily.vue\nindex ec13c01..0ab772f 100644\n--- a/src/features/tabs/TabFamily.vue\n+++ b/src/features/tabs/TabFamily.vue\n@@ -15,20 +15,21 @@\n \n <script setup lang=\"ts\">\n import Sticky from \"components/layout/Sticky.vue\";\n-import { isType } from \"features/feature\";\n-import { render } from \"util/vue\";\n-import type { Component } from \"vue\";\n-import { computed, unref } from \"vue\";\n-import { TabType } from \"./tab\";\n-import { TabFamily } from \"./tabFamily\";\n import themes from \"data/themes\";\n+import { isType } from \"features/feature\";\n import settings from \"game/settings\";\n+import { MaybeGetter } from \"util/computed\";\n+import { render, Renderable } from \"util/vue\";\n+import type { Component, CSSProperties, MaybeRef, Ref } from \"vue\";\n+import { computed, unref } from \"vue\";\n+import { Tab, TabType } from \"./tab\";\n+import { TabButton } from \"./tabFamily\";\n \n const props = defineProps<{\n-    activeTab: TabFamily[\"activeTab\"];\n-    tabs: TabFamily[\"tabs\"];\n-    buttonContainerClasses: TabFamily[\"buttonContainerClasses\"];\n-    buttonContainerStyle: TabFamily[\"buttonContainerStyle\"];\n+    activeTab: Ref<MaybeGetter<Renderable> | Tab | null>;\n+    tabs: Record<string, TabButton>;\n+    buttonContainerClasses?: MaybeRef<Record<string, boolean>>;\n+    buttonContainerStyle?: MaybeRef<CSSProperties>;\n }>();\n \n const Component = () => {\ndiff --git a/src/features/tabs/tab.ts b/src/features/tabs/tab.ts\nindex 1441ff7..39392f7 100644\n--- a/src/features/tabs/tab.ts\n+++ b/src/features/tabs/tab.ts\n@@ -15,7 +15,7 @@ export interface TabOptions extends VueFeatureOptions {\n \n /**\n  * An object representing a tab of content in a tabbed interface.\n- * @see {@link TabFamily}\n+ * @see {@link features/tabs/tabFamily.TabFamily}\n  */\n export interface Tab extends VueFeature {\n     /** The display to use for this tab. */\ndiff --git a/src/features/trees/Tree.vue b/src/features/trees/Tree.vue\nindex 22f2c72..7e255c7 100644\n--- a/src/features/trees/Tree.vue\n+++ b/src/features/trees/Tree.vue\n@@ -8,15 +8,15 @@\n <script setup lang=\"tsx\">\n import \"components/common/table.css\";\n import Links from \"features/links/Links.vue\";\n-import type { Tree } from \"features/trees/tree\";\n+import type { Tree, TreeBranch, TreeNode } from \"features/trees/tree\";\n import { render } from \"util/vue\";\n-import { unref } from \"vue\";\n+import { MaybeRef, unref } from \"vue\";\n \n const props = defineProps<{\n-    nodes: Tree[\"nodes\"];\n-    leftSideNodes: Tree[\"leftSideNodes\"];\n-    rightSideNodes: Tree[\"rightSideNodes\"];\n-    branches: Tree[\"branches\"];\n+    nodes: MaybeRef<TreeNode[][]>;\n+    leftSideNodes?: MaybeRef<TreeNode[]>;\n+    rightSideNodes?: MaybeRef<TreeNode[]>;\n+    branches?: MaybeRef<TreeBranch[]>;\n }>();\n \n const Nodes = () => unref(props.nodes).map(nodes => \ndiff --git a/src/features/trees/TreeNode.vue b/src/features/trees/TreeNode.vue\nindex 22ed704..c13a243 100644\n--- a/src/features/trees/TreeNode.vue\n+++ b/src/features/trees/TreeNode.vue\n@@ -10,7 +10,7 @@\n             treeNode: true,\n             can: unref(canClick)\n         }\"\n-        @click=\"onClick\"\n+        @click=\"e => emits('click', e)\"\n         @mousedown=\"start\"\n         @mouseleave=\"stop\"\n         @mouseup=\"stop\"\n@@ -23,23 +23,26 @@\n </template>\n \n <script setup lang=\"tsx\">\n-import { render, setupHoldToClick } from \"util/vue\";\n-import { toRef, unref } from \"vue\";\n-import { TreeNode } from \"./tree\";\n+import { MaybeGetter } from \"util/computed\";\n+import { render, Renderable, setupHoldToClick } from \"util/vue\";\n+import { MaybeRef, toRef, unref } from \"vue\";\n \n const props = defineProps<{\n-    canClick: TreeNode[\"canClick\"];\n-    display: TreeNode[\"display\"];\n-    onClick: TreeNode[\"onClick\"];\n-    onHold: TreeNode[\"onHold\"];\n-    color: TreeNode[\"color\"];\n-    glowColor: TreeNode[\"glowColor\"];\n+    canClick?: MaybeRef<boolean>;\n+    display?: MaybeGetter<Renderable>;\n+    color?: MaybeRef<string>;\n+    glowColor?: MaybeRef<string>;\n+}>();\n+\n+const emits = defineEmits<{\n+    (e: \"click\", event?: MouseEvent | TouchEvent): void;\n+    (e: \"hold\"): void;\n }>();\n \n const Component = () => props.display == null ? <></> :\n     render(props.display, el => <div>{el}</div>);\n \n-const { start, stop } = setupHoldToClick(toRef(props, \"onClick\"), toRef(props, \"onHold\"));\n+const { start, stop } = setupHoldToClick(() => emits(\"hold\"));\n </script>\n <style scoped>\ndiff --git a/src/game/boards/Draggable.vue b/src/game/boards/Draggable.vue\nindex a052513..840b81a 100644\n--- a/src/game/boards/Draggable.vue\n+++ b/src/game/boards/Draggable.vue\n@@ -3,10 +3,10 @@\n         class=\"board-node\"\n         :style=\"`transform: translate(calc(${unref(position).x}px - 50%), ${unref(position).y}px);`\"\n         @click.capture.stop=\"() => {}\"\n-        @mousedown=\"mouseDown\"\n-        @touchstart.passive=\"mouseDown\"\n-        @mouseup.capture=\"mouseUp\"\n-        @touchend.passive=\"mouseUp\"\n+        @mousedown=\"e => emits('mouseDown', e)\"\n+        @touchstart.passive=\"e => emits('mouseDown', e)\"\n+        @mouseup.capture=\"e => emits('mouseUp', e)\"\n+        @touchend.passive=\"e => emits('mouseUp', e)\"\n     >\n         <slot />\n     </div>\n@@ -17,8 +17,11 @@ import { Ref, unref } from \"vue\";\n import { NodePosition } from \"./board\";\n \n defineProps<{\n-    mouseDown: (e: MouseEvent | TouchEvent) => void;\n-    mouseUp: (e: MouseEvent | TouchEvent) => void;\n     position: Ref<NodePosition>;\n }>();\n+\n+const emits = defineEmits<{\n+    (e: \"mouseDown\", event: MouseEvent | TouchEvent): void;\n+    (e: \"mouseUp\", event: MouseEvent | TouchEvent): void;\n+}>();\n </script>\n<p>diff --git a/src/game/boards/board.tsx b/src/game/boards/board.tsx<br>\nindex 4ef9080…bcdbc7b 100644<br>\n— a/src/game/boards/board.tsx<br>\n+++ b/src/game/boards/board.tsx<br>\n@@ -51,7 +51,7 @@ export function setupUniqueIds(nodes: MaybeRefOrGetter&lt;{ id: number }[]&gt;) {</p>\n<p>/** An object that configures a {@link DraggableNode}. */<br>\nexport interface DraggableNodeOptions<T> {</p>\n<ul>\n<li>/** A ref to the specific instance of the Board vue component the node will be draggable on. Obtained by passing a suitable ref as the “ref” attribute to the <Board> element. */</li>\n</ul>\n<ul>\n<li>/** A ref to the specific instance of the Board vue component the node will be draggable on. Obtained by passing a suitable ref as the “ref” attribute to the Board component. <em>/<br>\nboard: Ref&lt;ComponentPublicInstance<typeof Board> | undefined&gt;;<br>\n/</em>* Getter function to go from the node (typically ID) to the position of said node. <em>/<br>\ngetPosition: (node: T) =&gt; NodePosition;<br>\n@@ -266,7 +266,7 @@ export interface Draggable<T> extends MakeDraggableOptions<T> {<br>\n/</em>*</li>\n</ul>\n<ul>\n<li>Makes a vue feature draggable on a Board.</li>\n<li>@param element The vue feature to make draggable.</li>\n</ul>\n<ul>\n<li>\n<ul>\n<li>@param options The options to configure the dragging behavior.</li>\n</ul>\n</li>\n</ul>\n<ul>\n<li>\n<ul>\n<li>@param optionsFunc The options to configure the dragging behavior.<br>\n*/<br>\nexport function makeDraggable&lt;T, S extends MakeDraggableOptions<T>&gt;(<br>\nelement: VueFeature,<br>\n@@ -337,8 +337,8 @@ export function makeDraggable&lt;T, S extends MakeDraggableOptions<T>&gt;(<br>\n(el as VueFeature &amp; { draggable: Draggable<T> }).draggable = draggable;<br>\nelement.wrappers.push(el =&gt; (<br>\n&lt;Draggable</li>\n</ul>\n</li>\n</ul>\n<ul>\n<li>\n<pre><code>           mouseDown={draggable.onMouseDown}\n</code></pre>\n</li>\n<li>\n<pre><code>           mouseUp={draggable.onMouseUp}\n</code></pre>\n</li>\n</ul>\n<ul>\n<li>\n<pre><code>           onMouseDown={draggable.onMouseDown}\n</code></pre>\n</li>\n<li>\n<pre><code>           onMouseUp={draggable.onMouseUp}\n           position={draggable.computedPosition}\n       &gt;\n           {el}\n</code></pre>\n</li>\n</ul>\n<p>diff --git a/src/game/events.ts b/src/game/events.ts<br>\nindex c89cca3…f270ee1 100644<br>\n— a/src/game/events.ts<br>\n+++ b/src/game/events.ts<br>\n@@ -27,7 +27,6 @@ export interface GlobalEvents {<br>\n* Sent when constructing the {@link Settings} object.<br>\n* Use it to add default values for custom properties to the object.<br>\n* @param settings The settings object being constructed.</p>\n<ul>\n<li>\n<pre><code>* @see {@link features/features.setDefault} for setting default values.\n*/\n</code></pre>\nloadSettings: (settings: Partial<Settings>) =&gt; void;<br>\n/**<br>\ndiff --git a/src/game/formulas/formulas.ts b/src/game/formulas/formulas.ts<br>\nindex 7ffe6ec…a857436 100644<br>\n— a/src/game/formulas/formulas.ts<br>\n+++ b/src/game/formulas/formulas.ts<br>\n@@ -1290,7 +1290,7 @@ export abstract class InternalFormula&lt;T extends [FormulaSource] | FormulaSource[\n<ul>\n<li>A class that can be used for cost/goal functions. It can be evaluated similar to a cost function, but also provides extra features for supported formulas. For example, a lot of math functions can be inverted.</li>\n<li>Typically, the use of these extra features is to support cost/goal functions that have multiple levels purchased/completed at once efficiently.</li>\n<li>@see {@link calculateMaxAffordable}</li>\n</ul>\n</li>\n<li>\n<ul>\n<li>@see {@link /game/requirements.createCostRequirement}</li>\n</ul>\n</li>\n</ul>\n<ul>\n<li>\n<ul>\n<li>@see {@link game/requirements.createCostRequirement}<br>\n*/<br>\nexport default class Formula&lt;<br>\nT extends [FormulaSource] | FormulaSource[]<br>\ndiff --git a/src/game/layers.tsx b/src/game/layers.tsx<br>\nindex 07c5656…9e57529 100644<br>\n— a/src/game/layers.tsx<br>\n+++ b/src/game/layers.tsx<br>\n@@ -29,22 +29,22 @@ export interface FeatureNode {<br>\n}</li>\n</ul>\n</li>\n</ul>\n<p>/**</p>\n<ul>\n<li>\n<ul>\n<li>An injection key that a {@link ContextComponent} will use to provide a function that registers a {@link FeatureNode} with the given id and HTML element.</li>\n</ul>\n</li>\n</ul>\n<ul>\n<li>\n<ul>\n<li>An injection key that a Context component will use to provide a function that registers a {@link FeatureNode} with the given id and HTML element.<br>\n<em>/<br>\nexport const RegisterNodeInjectionKey: InjectionKey&lt;(id: string, element: HTMLElement) =&gt; void&gt; =<br>\nSymbol(“RegisterNode”);<br>\n/</em>*</li>\n</ul>\n</li>\n</ul>\n<ul>\n<li>\n<ul>\n<li>An injection key that a {@link ContextComponent} will use to provide a function that unregisters a {@link FeatureNode} with the given id.</li>\n</ul>\n</li>\n</ul>\n<ul>\n<li>\n<ul>\n<li>An injection key that a Context component will use to provide a function that unregisters a {@link FeatureNode} with the given id.<br>\n<em>/<br>\nexport const UnregisterNodeInjectionKey: InjectionKey&lt;(id: string) =&gt; void&gt; =<br>\nSymbol(“UnregisterNode”);<br>\n/</em>*</li>\n</ul>\n</li>\n</ul>\n<ul>\n<li>\n<ul>\n<li>An injection key that a {@link ContextComponent} will use to provide a ref to a map of all currently registered {@link FeatureNode}s.</li>\n</ul>\n</li>\n</ul>\n<ul>\n<li>\n<ul>\n<li>An injection key that a Context component will use to provide a ref to a map of all currently registered {@link FeatureNode}s.<br>\n<em>/<br>\nexport const NodesInjectionKey: InjectionKey&lt;Ref&lt;Record&lt;string, FeatureNode | undefined&gt;&gt;&gt; =<br>\nSymbol(“Nodes”);<br>\n/</em>*</li>\n</ul>\n</li>\n</ul>\n<ul>\n<li>\n<ul>\n<li>An injection key that a {@link ContextComponent} will use to provide a ref to a bounding rect of the Context.</li>\n</ul>\n</li>\n</ul>\n<ul>\n<li>\n<ul>\n<li>An injection key that a Context component will use to provide a ref to a bounding rect of the Context.<br>\n*/<br>\nexport const BoundsInjectionKey: InjectionKey&lt;Ref&lt;DOMRect | undefined&gt;&gt; = Symbol(“Bounds”);</li>\n</ul>\n</li>\n</ul>\n<p>@@ -106,7 +106,7 @@ export interface LayerOptions {<br>\ncolor?: MaybeRefOrGetter<string>;<br>\n/**<br>\n* The layout of this layer’s features.</p>\n<ul>\n<li>\n<pre><code>* When the layer is open in {@link game/player.PlayerData.tabs}, this is the content that is displayed.\n</code></pre>\n</li>\n</ul>\n<ul>\n<li>\n<pre><code>* When the layer is open in {@link game/player.Player.tabs}, this is the content that is displayed.\n*/\n</code></pre>\ndisplay: MaybeGetter<Renderable>;<br>\n/** An object of classes that should be applied to the display. <em>/<br>\n@@ -125,12 +125,12 @@ export interface LayerOptions {<br>\nminimizable?: MaybeRefOrGetter<boolean>;<br>\n/</em>*<br>\n* The layout of this layer’s features.</li>\n</ul>\n<ul>\n<li>\n<pre><code>* When the layer is open in {@link game/player.PlayerData.tabs}, but the tab is {@link Layer.minimized} this is the content that is displayed.\n</code></pre>\n</li>\n</ul>\n<ul>\n<li>\n<pre><code>* When the layer is open in {@link game/player.Player.tabs}, but the tab is {@link Layer.minimized} this is the content that is displayed.\n*/\n</code></pre>\nminimizedDisplay?: MaybeGetter<Renderable>;<br>\n/**<br>\n* Whether or not to force the go back button to be hidden.</li>\n</ul>\n<ul>\n<li>\n<pre><code>* If true, go back will be hidden regardless of {@link data/projInfo.allowGoBack}.\n</code></pre>\n</li>\n</ul>\n<ul>\n<li>\n<pre><code>* If true, go back will be hidden regardless of allowGoBack value in the project settings.\n*/\n</code></pre>\nforceHideGoBack?: MaybeRefOrGetter<boolean>;<br>\n/**<br>\n@@ -157,7 +157,7 @@ export interface BaseLayer {<br>\non: OmitThisParameter&lt;Emitter<LayerEvents>[“on”]&gt;;<br>\n/** A function to emit a {@link LayerEvents} event to this layer. */<br>\nemit: <K extends keyof LayerEvents>(…args: [K, …Parameters&lt;LayerEvents[K]&gt;]) =&gt; void;</li>\n</ul>\n<ul>\n<li>/** A map of {@link FeatureNode}s present in this layer’s {@link ContextComponent} component. */</li>\n</ul>\n<ul>\n<li>/** A map of {@link FeatureNode}s present in this layer’s Context component. */<br>\nnodes: Ref&lt;Record&lt;string, FeatureNode | undefined&gt;&gt;;<br>\n}</li>\n</ul>\n<p>@@ -167,7 +167,7 @@ export interface Layer extends BaseLayer {<br>\ncolor?: MaybeRef<string>;<br>\n/**<br>\n* The layout of this layer’s features.</p>\n<ul>\n<li>\n<pre><code>* When the layer is open in {@link game/player.PlayerData.tabs}, this is the content that is displayed.\n</code></pre>\n</li>\n</ul>\n<ul>\n<li>\n<pre><code>* When the layer is open in {@link game/player.Player.tabs}, this is the content that is displayed.\n*/\n</code></pre>\ndisplay: MaybeGetter<Renderable>;<br>\n/** An object of classes that should be applied to the display. <em>/<br>\n@@ -186,12 +186,12 @@ export interface Layer extends BaseLayer {<br>\nminimizable?: MaybeRef<boolean>;<br>\n/</em>*<br>\n* The layout of this layer’s features.</li>\n</ul>\n<ul>\n<li>\n<pre><code>* When the layer is open in {@link game/player.PlayerData.tabs}, but the tab is {@link Layer.minimized} this is the content that is displayed.\n</code></pre>\n</li>\n</ul>\n<ul>\n<li>\n<pre><code>* When the layer is open in {@link game/player.Player.tabs}, but the tab is {@link Layer.minimized} this is the content that is displayed.\n*/\n</code></pre>\nminimizedDisplay?: MaybeGetter<Renderable>;<br>\n/**<br>\n* Whether or not to force the go back button to be hidden.</li>\n</ul>\n<ul>\n<li>\n<pre><code>* If true, go back will be hidden regardless of {@link data/projInfo.allowGoBack}.\n</code></pre>\n</li>\n</ul>\n<ul>\n<li>\n<pre><code>* If true, go back will be hidden regardless of allowGoBack value in the project settings.\n*/\n</code></pre>\nforceHideGoBack?: MaybeRef<boolean>;<br>\n/**<br>\ndiff --git a/src/game/notifications.ts b/src/game/notifications.ts<br>\nindex 46039b8…f130b40 100644<br>\n— a/src/game/notifications.ts<br>\n+++ b/src/game/notifications.ts<br>\n@@ -1,15 +1,14 @@<br>\nimport { globalBus } from “game/events”;<br>\nimport { processGetter } from “util/computed”;<br>\nimport { trackHover, VueFeature } from “util/vue”;<br>\n-import { nextTick, Ref } from “vue”;<br>\n-import { ref, watch } from “vue”;<br>\n+import { CSSProperties, nextTick, Ref, ref, watch } from “vue”;<br>\nimport Toast from “vue-toastification”;<br>\nimport “vue-toastification/dist/index.css”;</li>\n</ul>\n<p>globalBus.on(“setupVue”, vue =&gt; vue.use(Toast));</p>\n<p>/**</p>\n<ul>\n<li>\n<ul>\n<li>Gives a {@link CSSProperties} object that makes an object glow, to bring focus to it.</li>\n</ul>\n</li>\n</ul>\n<ul>\n<li>\n<ul>\n<li>Gives a <a href=\"https://vuejs.org/api/utility-types.html#cssproperties\">CSSProperties</a> object that makes an object glow, to bring focus to it.</li>\n<li>Default values are for a “soft” white notif effect.</li>\n<li>@param color The color of the glow effect.</li>\n<li>@param strength The strength of the glow effect - affects its spread.<br>\n@@ -20,7 +19,7 @@ export function getNotifyStyle(color = “white”, strength = “8px”) {<br>\nborderColor: “rgba(0, 0, 0, 0.125)”,<br>\nboxShadow: <code>-4px -4px 4px rgba(0, 0, 0, 0.25) inset, 0 0 ${strength} ${color}</code>,<br>\nzIndex: 1</li>\n</ul>\n</li>\n</ul>\n<ul>\n<li>};</li>\n</ul>\n<ul>\n<li>} satisfies CSSProperties;<br>\n}</li>\n</ul>\n<p>/** Utility function to call {@link getNotifyStyle} with “high importance” parameters. */<br>\ndiff --git a/src/game/persistence.ts b/src/game/persistence.ts<br>\nindex e4904c4…e74d79a 100644<br>\n— a/src/game/persistence.ts<br>\n+++ b/src/game/persistence.ts<br>\n@@ -67,7 +67,7 @@ export type State =<br>\n| { [key: number]: State };</p>\n<p>/**</p>\n<ul>\n<li>\n<ul>\n<li>A {@link Ref} that has been augmented with properties to allow it to be saved and loaded within the player save data object.</li>\n</ul>\n</li>\n</ul>\n<ul>\n<li>\n<ul>\n<li>A <a href=\"https://vuejs.org/api/reactivity-core.html#ref\">Ref</a> that has been augmented with properties to allow it to be saved and loaded within the player save data object.<br>\n*/<br>\nexport type Persistent<T extends State = State> = Ref<T> &amp; {<br>\nvalue: T;<br>\ndiff --git a/src/game/requirements.tsx b/src/game/requirements.tsx<br>\nindex 15d6368…eda7d2f 100644<br>\n— a/src/game/requirements.tsx<br>\n+++ b/src/game/requirements.tsx<br>\n@@ -1,6 +1,6 @@<br>\nimport { isVisible, Visibility } from “features/feature”;<br>\nimport { displayResource, Resource } from “features/resources/resource”;<br>\n-import Decimal, { DecimalSource } from “lib/break_eternity”;<br>\n+import Decimal, { DecimalSource } from “util/bignum”;<br>\nimport { MaybeGetter, processGetter } from “util/computed”;<br>\nimport { createLazyProxy } from “util/proxies”;<br>\nimport { joinJSX, Renderable } from “util/vue”;<br>\n@@ -243,7 +243,7 @@ export function createCostRequirement<T extends CostRequirementOptions>(optionsF</li>\n</ul>\n</li>\n</ul>\n<p>/**</p>\n<ul>\n<li>Utility function for creating a requirement that a specified vue feature is visible</li>\n</ul>\n<ul>\n<li>\n<ul>\n<li>@param feature The feature to check the visibility of</li>\n</ul>\n</li>\n</ul>\n<ul>\n<li>\n<ul>\n<li>@param visibility The visibility ref to check<br>\n*/<br>\nexport function createVisibilityRequirement(<br>\nvisibility: MaybeRef&lt;Visibility | boolean&gt;<br>\ndiff --git a/src/game/settings.ts b/src/game/settings.ts<br>\nindex 8b0c464…6c94271 100644<br>\n— a/src/game/settings.ts<br>\n+++ b/src/game/settings.ts<br>\n@@ -77,7 +77,7 @@ export const hardResetSettings = (window.hardResetSettings = () =&gt; {</li>\n</ul>\n</li>\n</ul>\n<p>/**</p>\n<ul>\n<li>Loads the player settings from localStorage.</li>\n</ul>\n<ul>\n<li>\n<ul>\n<li>Calls the {@link GlobalEvents.loadSettings} event for custom properties to be included.</li>\n</ul>\n</li>\n</ul>\n<ul>\n<li>\n<ul>\n<li>Calls the {@link game/events.GlobalEvents.loadSettings} event for custom properties to be included.</li>\n<li>Custom properties should be added by the file they relate to, so they won’t be included if the file is tree shaken away.</li>\n<li>Custom properties should also register the field to modify said setting using {@link registerSettingField}.<br>\n*/<br>\ndiff --git a/src/main.ts b/src/main.ts<br>\nindex bb5b2cc…e502bb8 100644<br>\n— a/src/main.ts<br>\n+++ b/src/main.ts<br>\n@@ -9,8 +9,8 @@ import { useRegisterSW } from “virtual:pwa-register/vue”;<br>\nimport type { App as VueApp } from “vue”;<br>\nimport { createApp, nextTick } from “vue”;<br>\nimport { useToast } from “vue-toastification”;<br>\n-import { globalBus } from “./game/events”;<br>\n-import { startGameLoop } from “./game/gameLoop”;<br>\n+import { globalBus } from “game/events”;<br>\n+import { startGameLoop } from “game/gameLoop”;</li>\n</ul>\n</li>\n</ul>\n<p>declare global {<br>\n/**<br>\ndiff --git a/src/util/galaxy.ts b/src/util/galaxy.ts<br>\nindex b59ead5…64790f9 100644<br>\n— a/src/util/galaxy.ts<br>\n+++ b/src/util/galaxy.ts<br>\n@@ -1,10 +1,9 @@<br>\n-import { LoadablePlayerData } from “components/modals/SavesManager.vue”;<br>\nimport player, { Player, stringifySave } from “game/player”;<br>\nimport settings from “game/settings”;<br>\nimport LZString from “lz-string”;<br>\nimport { GalaxyApi, initGalaxy } from “unofficial-galaxy-sdk”;<br>\nimport { ref } from “vue”;<br>\n-import { decodeSave, loadSave, save, setupInitialStore } from “./save”;<br>\n+import { decodeSave, LoadablePlayerData, loadSave, save, setupInitialStore } from “./save”;</p>\n<p>export const galaxy = ref<GalaxyApi>();<br>\nexport const conflictingSaves = ref&lt;<br>\ndiff --git a/src/util/proxies.ts b/src/util/proxies.ts<br>\nindex 31984e8…4bd2ced 100644<br>\n— a/src/util/proxies.ts<br>\n+++ b/src/util/proxies.ts<br>\n@@ -3,8 +3,12 @@ import { NonPersistent } from “game/persistence”;<br>\nexport const ProxyState = Symbol(“ProxyState”);<br>\nexport const AfterEvaluation = Symbol(“AfterEvaluation”);</p>\n<p>-// Takes a function that returns an object and pretends to be that object<br>\n-// Note that the object is lazily calculated<br>\n+/**</p>\n<ul>\n<li>\n<ul>\n<li>Makes a lazily evaluated object through the use of a Proxy</li>\n</ul>\n</li>\n<li>\n<ul>\n<li>@param objectFunc Function that constructs the object to be proxies</li>\n</ul>\n</li>\n<li>\n<ul>\n<li>@param baseObject An optional base object to pass to objectFunc, which all return properties will be assigned onto</li>\n</ul>\n</li>\n<li>\n<ul>\n<li>@returns A proxy for the object created by objectFunc</li>\n</ul>\n</li>\n<li>*/<br>\nexport function createLazyProxy&lt;T extends object, S extends T&gt;(<br>\nobjectFunc: (this: S, baseObject: S) =&gt; T,<br>\nbaseObject: S = {} as S<br>\n@@ -74,6 +78,11 @@ export function createLazyProxy&lt;T extends object, S extends T&gt;(<br>\n}) as S &amp; T;<br>\n}</li>\n</ul>\n<p>+/**</p>\n<ul>\n<li>\n<ul>\n<li>Registers a callback to be called on a lazily evaluated proxy once its been evaluated.</li>\n</ul>\n</li>\n<li>\n<ul>\n<li>@param maybeProxy A value that may be a lazily evaluated proxy</li>\n</ul>\n</li>\n<li>\n<ul>\n<li>@param callback The callback to call once the proxy has been evaluated (or immediately, if the object is not a proxy)</li>\n</ul>\n</li>\n<li>*/<br>\nexport function runAfterEvaluation<T extends object>(maybeProxy: T, callback: (object: T) =&gt; void) {<br>\nif (AfterEvaluation in maybeProxy) {<br>\n(maybeProxy[AfterEvaluation] as (callback: (object: T) =&gt; void) =&gt; void)(callback);<br>\ndiff --git a/src/util/save.ts b/src/util/save.ts<br>\nindex 806c3fe…10fd5b5 100644<br>\n— a/src/util/save.ts<br>\n+++ b/src/util/save.ts<br>\n@@ -1,4 +1,3 @@<br>\n-import { LoadablePlayerData } from “components/modals/SavesManager.vue”;<br>\nimport { fixOldSave, getInitialLayers } from “data/projEntry”;<br>\nimport projInfo from “data/projInfo.json”;<br>\nimport { globalBus } from “game/events”;<br>\n@@ -9,6 +8,8 @@ import settings, { loadSettings } from “game/settings”;<br>\nimport LZString from “lz-string”;<br>\nimport { ref, shallowReactive } from “vue”;</li>\n</ul>\n<p>+export type LoadablePlayerData = Omit&lt;Partial<Player>, “id”&gt; &amp; { id: string; error?: unknown };<br>\n+<br>\nexport function setupInitialStore(player: Partial<Player> = {}): Player {<br>\nreturn Object.assign(<br>\n{<br>\ndiff --git a/src/util/vue.tsx b/src/util/vue.tsx<br>\nindex ecc99bf…21296cf 100644<br>\n— a/src/util/vue.tsx<br>\n+++ b/src/util/vue.tsx<br>\n@@ -15,6 +15,7 @@ import { camelToKebab } from “./common”;<br>\nexport const VueFeature = Symbol(“VueFeature”);</p>\n<p>export type Renderable = JSX.Element | string;<br>\n+export type Wrapper = (el: () =&gt; Renderable) =&gt; Renderable;</p>\n<p>export interface VueFeatureOptions {<br>\n/** Whether this feature should be visible. <em>/<br>\n@@ -37,7 +38,7 @@ export interface VueFeature {<br>\n/</em>* The components to render inside the vue feature <em>/<br>\ncomponents: MaybeGetter<Renderable>[];<br>\n/</em>* The components to render wrapped around the vue feature */</p>\n<ul>\n<li>wrappers: ((el: () =&gt; Renderable) =&gt; Renderable)[];</li>\n</ul>\n<ul>\n<li>wrappers: Wrapper[];<br>\n/** Used to identify Vue Features */<br>\n[VueFeature]: true;<br>\n}<br>\n@@ -53,7 +54,7 @@ export function vueFeatureMixin(<br>\nclasses: processGetter(options.classes),<br>\nstyle: processGetter(options.style),<br>\ncomponents: component == null ? [] : [component],</li>\n</ul>\n<ul>\n<li>\n<pre><code>   wrappers: [] as ((el: () =&gt; Renderable) =&gt; Renderable)[],\n</code></pre>\n</li>\n</ul>\n<ul>\n<li>\n<pre><code>   wrappers: [] as Wrapper[],\n   [VueFeature]: true\n</code></pre>\n} satisfies VueFeature;<br>\n}<br>\n@@ -119,10 +120,7 @@ export function isJSXElement(element: unknown): element is JSX.Element {<br>\n);<br>\n}</li>\n</ul>\n<p>-export function setupHoldToClick(</p>\n<ul>\n<li>onClick?: Ref&lt;((e?: MouseEvent | TouchEvent) =&gt; void) | undefined&gt;,</li>\n<li>onHold?: Ref&lt;VoidFunction | undefined&gt;<br>\n-): {<br>\n+export function setupHoldToClick(callback: (e?: MouseEvent | TouchEvent) =&gt; void): {<br>\nstart: (e: MouseEvent | TouchEvent) =&gt; void;<br>\nstop: VoidFunction;<br>\nhandleHolding: VoidFunction;<br>\n@@ -143,11 +141,7 @@ export function setupHoldToClick(<br>\n}<br>\n}<br>\nfunction handleHolding() {</li>\n<li>\n<pre><code>   if (onHold &amp;&amp; onHold.value) {\n</code></pre>\n</li>\n<li>\n<pre><code>       onHold.value();\n</code></pre>\n</li>\n<li>\n<pre><code>   } else if (onClick &amp;&amp; onClick.value) {\n</code></pre>\n</li>\n<li>\n<pre><code>       onClick.value(event.value);\n</code></pre>\n</li>\n<li>\n<pre><code>   }\n</code></pre>\n</li>\n</ul>\n<ul>\n<li>\n<pre><code>   callback(event.value);\n</code></pre>\n<p>}</p>\n<p>onUnmounted(stop);<br>\ndiff --git a/src/wrappers/marks/mark.tsx b/src/wrappers/marks/mark.tsx<br>\nindex d269353…969c768 100644<br>\n— a/src/wrappers/marks/mark.tsx<br>\n+++ b/src/wrappers/marks/mark.tsx<br>\n@@ -20,7 +20,7 @@ export interface Mark {<br>\n/**</p>\n<ul>\n<li>Creates a mark to the top left of the given element with the given options.</li>\n<li>@param element The renderable feature to display the tooltip on.</li>\n</ul>\n</li>\n</ul>\n<ul>\n<li>\n<ul>\n<li>@param options Mark options.</li>\n</ul>\n</li>\n</ul>\n<ul>\n<li>\n<ul>\n<li>@param optionsFunc Mark options.<br>\n*/<br>\nexport function addMark(<br>\nelement: VueFeature,<br>\ndiff --git a/src/wrappers/tooltips/Tooltip.vue b/src/wrappers/tooltips/Tooltip.vue<br>\nindex 20a6046…37f1020 100644<br>\n— a/src/wrappers/tooltips/Tooltip.vue<br>\n+++ b/src/wrappers/tooltips/Tooltip.vue<br>\n@@ -37,19 +37,19 @@<br>\nimport themes from “data/themes”;<br>\nimport settings from “game/settings”;<br>\nimport { Direction } from “util/common”;<br>\n-import { render } from “util/vue”;<br>\n-import type { Component } from “vue”;<br>\n+import { MaybeGetter } from “util/computed”;<br>\n+import { render, Renderable } from “util/vue”;<br>\n+import type { Component, CSSProperties, MaybeRef, Ref } from “vue”;<br>\nimport { computed, ref, unref } from “vue”;<br>\n-import { Tooltip } from “./tooltip”;</li>\n</ul>\n</li>\n</ul>\n<p>const props = defineProps&lt;{</p>\n<ul>\n<li>pinned?: Tooltip[“pinned”];</li>\n<li>display: Tooltip[“display”];</li>\n<li>style?: Tooltip[“style”];</li>\n<li>classes?: Tooltip[“classes”];</li>\n<li>direction: Tooltip[“direction”];</li>\n<li>xoffset?: Tooltip[“xoffset”];</li>\n<li>yoffset?: Tooltip[“yoffset”];</li>\n</ul>\n<ul>\n<li>pinned?: Ref<boolean>;</li>\n<li>display: MaybeGetter<Renderable>;</li>\n<li>style?: MaybeRef<CSSProperties>;</li>\n<li>classes?: MaybeRef&lt;Record&lt;string, boolean&gt;&gt;;</li>\n<li>direction: MaybeRef<Direction>;</li>\n<li>xoffset?: MaybeRef<string>;</li>\n<li>yoffset?: MaybeRef<string>;<br>\n}&gt;();</li>\n</ul>\n<p>const isHovered = ref(false);<br>\ndiff --git a/src/wrappers/tooltips/tooltip.tsx b/src/wrappers/tooltips/tooltip.tsx<br>\nindex f736688…d7ece95 100644<br>\n— a/src/wrappers/tooltips/tooltip.tsx<br>\n+++ b/src/wrappers/tooltips/tooltip.tsx<br>\n@@ -49,7 +49,7 @@ export interface Tooltip extends VueFeature {<br>\n/**</p>\n<ul>\n<li>Creates a tooltip on the given element with the given options.</li>\n<li>@param element The renderable feature to display the tooltip on.</li>\n</ul>\n<ul>\n<li>\n<ul>\n<li>@param options Tooltip options.</li>\n</ul>\n</li>\n</ul>\n<ul>\n<li>\n<ul>\n<li>@param optionsFunc Tooltip options.<br>\n*/<br>\nexport function addTooltip(<br>\nelement: VueFeature,</li>\n</ul>\n</li>\n</ul>","url":"https://github.com/profectus-engine/Profectus","published":1735650260000,"tags":["programming"],"syndications":["https://github.com/profectus-engine/Profectus/commit/67ca253f5c4704e76e1d3900dfe2ea17963d2f3b"]}